name: Auto Label Issues

on:
  issues:
    types: [opened]

jobs:
  label-issues:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      
    - name: Auto-label issues
      uses: actions/github-script@v7
      with:
        script: |
          const issue = context.payload.issue;
          const title = issue.title.toLowerCase();
          const body = issue.body ? issue.body.toLowerCase() : '';
          const combinedText = title + ' ' + body;
          
          const labels = [];
          
          // Check for bug keywords
          if (combinedText.includes('error') || combinedText.includes('bug') || combinedText.includes('fix')) {
            labels.push('bug');
          }
          
          // Check for feature keywords
          if (combinedText.includes('add') || combinedText.includes('feature') || combinedText.includes('enhancement')) {
            labels.push('feature');
          }
          
          // Add labels if any were found
          if (labels.length > 0) {
            await github.rest.issues.addLabels({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: issue.number,
              labels: labels
            });
            
            console.log(`Added labels: ${labels.join(', ')} to issue #${issue.number}`);
          } else {
            console.log(`No matching keywords found for issue #${issue.number}`);
          }